<script type='text/javascript'>var comments = <%=raw @post.get_comments_json.to_json %>; console.log(comments) </script>

<div id='post-container'>
	<div class='post-text'>
		<%= @post.text %>
	</div>
	
	<p class="post-author-details">
		<span class='post-type'><%= @post.post_type %></span>
		by <span class='post-author'><%= @post.user.username %></span>
		on <%= posted_on(@post.created_at) %>
	</p>

	<% if current_user %>
		<div class='main_add_comment_btn med-font'>
			<%= link_to "Add Comment", new_post_comment_path(@post) %>
		</div>
	<% end %>	

	<% if @post.editable? && @post.author == current_user %>
		<div class="edit_post_button med-font">
			<%= link_to "Edit post", edit_post_path(@post) %>
		</div>
	<% end %>
	
	<div data-id='<%= @post.id %>' id='main-add-comment-input'>
	</div>
</div>

<div id="comments-container">
	<% if @comments %>
	<ul>
		<% @comments.each do |comment| %>
			<li><%= render partial: 'comments/show', locals: { comment: comment } %></li>
		<% end %>
	</ul>
	<% end %>
</div>
